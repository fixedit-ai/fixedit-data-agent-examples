# Configuration for the GitHub API input plugin
# This plugin makes HTTPS requests to the GitHub API to fetch workflow status

[[inputs.http]]
  urls = ["https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/actions/runs?branch=${GITHUB_BRANCH}&per_page=1"]
  method = "GET"
  data_format = "json"
  name_override = "github_workflow"
  json_query = "workflow_runs"
  tag_keys = ["status", "conclusion"]
  json_string_fields = ["status", "conclusion", "name", "display_title", "id", "run_number"]

  [inputs.http.headers]
    Authorization = "Bearer ${GITHUB_TOKEN}"
    Accept = "application/json"
